package prj5;

import java.util.ArrayList;

/**
 * Song class for the music visualization
 * 
 * @author Pim Silpacharn pims617
 * @author Danni Nicholls ndanni4
 * @author Kevin Benson kbenson8
 * @version 4/16/17
 *
 */
public class Song {
    private int totalRead = 0;
    private int totalArt = 0;
    private int totalSports = 0;
    private int totalMusic = 0;

    private int totalComp = 0;
    private int totalEng = 0;
    private int totalMath = 0;
    private int totalOther = 0;

    private int totalSouth = 0;
    private int totalNorth = 0;
    private int totalUs = 0;
    private int totalNon = 0;

    private String title;
    private String artist;
    private String genre;
    private String year;

    private int numHeardRead = 0;
    private int numHeardArt = 0;
    private int numHeardSports = 0;
    private int numHeardMusic = 0;

    private int numHeardComp = 0;
    private int numHeardEng = 0;
    private int numHeardMath = 0;
    private int numHeardOther = 0;

    private int numLikeSouth = 0;
    private int numLikeNorth = 0;
    private int numLikeUs = 0;
    private int numLikeNon = 0;

    private int numLikeRead = 0;
    private int numLikeArt = 0;
    private int numLikeSports = 0;
    private int numLikeMusic = 0;

    private int numLikeComp = 0;
    private int numLikeEng = 0;
    private int numLikeMath = 0;
    private int numLikeOther = 0;

    private int numHeardSouth = 0;
    private int numHeardNorth = 0;
    private int numHeardUs = 0;
    private int numHeardNon = 0;

    private ArrayList<Person> likeArray;
    private ArrayList<Person> heardArray;


    /**
     * Constructor for sogn that takes 4 parameters
     * 
     * @param title1
     *            title
     * @param artist1
     *            artist
     * @param year1
     *            year
     * @param genre1
     *            genre
     */
    public Song(String title1, String artist1, String genre1, String year1) {

        likeArray = new ArrayList<Person>();
        heardArray = new ArrayList<Person>();
        title = title1;
        artist = artist1;
        genre = genre1;
        year = year1;
    }


    /**
     * Getter for title
     * 
     * @return song's title
     */
    public String getTitle() {
        return title;
    }


    /**
     * Getter for artist
     * 
     * @return song's artist
     */
    public String getArtist() {
        return artist;
    }


    /**
     * Getter for genre
     * 
     * @return song's genre
     */
    public String getGenre() {
        return genre;
    }


    /**
     * Getter for year
     * 
     * @return song's release date
     */
    public String getYear() {
        return year;
    }


    /**
     * 
     * @return ArrayList of people who like the song
     */
    public ArrayList<Person> getLike() {
        return likeArray;
    }


    /**
     * 
     * @return ArrayList of people who have heard the song
     */
    public ArrayList<Person> getHeard() {
        return heardArray;
    }


    /**
     * Adds the number of heards to an array
     * 
     * @param p
     *            person that has heard the song
     * @param add
     *            true if person has heard it, false if not
     */
    public void addHeard(Person p, boolean add) {

        heardArray.add(p);

        HobbyEnum hob = p.getHobby();
        MajorEnum maj = p.getMajor();
        RegionEnum reg = p.getState();
        if (hob == HobbyEnum.READING) {
            if (add) {
                numHeardRead++;
            }
            totalRead++;
        }
        else if (hob == HobbyEnum.ART) {
            if (add) {
                numHeardArt++;
            }
            totalArt++;
        }
        else if (hob == HobbyEnum.SPORTS) {
            if (add) {
                numHeardSports++;
            }
            totalSports++;
        }
        else if (hob == HobbyEnum.MUSIC) {
            if (add) {
                numHeardMusic++;
            }
            totalMusic++;
        }
        if (maj == MajorEnum.COMPSCI) {
            if (add) {
                numHeardComp++;
            }
            totalComp++;
        }
        else if (maj == MajorEnum.ENGINEERING) {
            if (add) {
                numHeardEng++;
            }
            totalEng++;
        }
        else if (maj == MajorEnum.MATH) {
            if (add) {
                numHeardMath++;
            }
            totalMath++;
        }
        else if (maj == MajorEnum.OTHER) {
            if (add) {
                numHeardOther++;
            }
            totalOther++;
        }
        if (reg == RegionEnum.SOUTHEAST) {
            if (add) {
                numHeardSouth++;
            }
            totalSouth++;
        }
        else if (reg == RegionEnum.NORTHEAST) {
            if (add) {
                numHeardNorth++;
            }
            totalNorth++;
        }
        else if (reg == RegionEnum.USOTHER) {
            if (add) {
                numHeardUs++;
            }
            totalUs++;
        }
        else if (reg == RegionEnum.OTHER) {
            if (add) {
                numHeardNon++;
            }
            totalNon++;
        }
    }


    /**
     * Add the number of likes to an array
     * 
     * @param p
     *            person that likes the song
     * @param add
     *            true if person likes it, false if not
     * 
     */
    public void addLike(Person p, boolean add) {

        likeArray.add(p);

        HobbyEnum hob = p.getHobby();
        MajorEnum maj = p.getMajor();
        RegionEnum reg = p.getState();
        if (hob == HobbyEnum.READING) {
            if (add) {
                numLikeRead++;
            }
        }
        else if (hob == HobbyEnum.ART) {
            if (add) {
                numLikeArt++;
            }
        }
        else if (hob == HobbyEnum.SPORTS) {
            if (add) {
                numLikeSports++;
            }
        }
        else if (hob == HobbyEnum.MUSIC) {
            if (add) {
                numLikeMusic++;
            }
        }
        if (maj == MajorEnum.COMPSCI) {
            if (add) {
                numLikeComp++;
            }
        }
        else if (maj == MajorEnum.ENGINEERING) {
            if (add) {
                numLikeEng++;
            }
        }
        else if (maj == MajorEnum.MATH) {
            if (add) {
                numLikeMath++;
            }
        }
        else if (maj == MajorEnum.OTHER) {
            if (add) {
                numLikeOther++;
            }
        }
        if (reg == RegionEnum.SOUTHEAST) {
            if (add) {
                numLikeSouth++;
            }
        }
        else if (reg == RegionEnum.NORTHEAST) {
            if (add) {
                numLikeNorth++;
            }
        }
        else if (reg == RegionEnum.USOTHER) {
            if (add) {
                numLikeUs++;
            }
        }
        else if (reg == RegionEnum.OTHER) {
            if (add) {
                numLikeNon++;
            }
        }
    }


    /**
     * Gets number of heard and puts into an array
     * 
     * @return int array of number of people who heard the song
     */
    public int[] getNumHeard() {
        int[] out = new int[12];
        for (int i = 0; i < 12; i++) {
            out[i] = 0;
        }
        for (int i = 0; i < heardArray.size(); i++) {
            if (heardArray.get(i).getHobby() == HobbyEnum.READING) {
                out[0]++;
            }
            else if (heardArray.get(i).getHobby() == HobbyEnum.ART) {
                out[1]++;
            }
            else if (heardArray.get(i).getHobby() == HobbyEnum.SPORTS) {
                out[2]++;
            }
            else if (heardArray.get(i).getHobby() == HobbyEnum.MUSIC) {
                out[3]++;
            }
            if (heardArray.get(i).getMajor() == MajorEnum.COMPSCI) {
                out[4]++;
            }
            else if (heardArray.get(i).getMajor() == MajorEnum.ENGINEERING) {
                out[5]++;
            }
            else if (heardArray.get(i).getMajor() == MajorEnum.MATH) {
                out[6]++;
            }
            else if (heardArray.get(i).getMajor() == MajorEnum.OTHER) {
                out[7]++;
            }
            if (heardArray.get(i).getState() == RegionEnum.SOUTHEAST) {
                out[8]++;
            }
            else if (heardArray.get(i).getState() == RegionEnum.NORTHEAST) {
                out[9]++;
            }
            else if (heardArray.get(i).getState() == RegionEnum.USOTHER) {
                out[10]++;
            }
            else if (heardArray.get(i).getState() == RegionEnum.OTHER) {
                out[11]++;
            }
        }
        return out;
    }


    /**
     * Gets the number of likes and puts into an array
     * 
     * @return int array of number of people who like the song
     */
    public int[] getNumLike() {
        int[] out = new int[12];
        for (int i = 0; i < 12; i++) {
            out[i] = 0;
        }
        for (int i = 0; i < likeArray.size(); i++) {
            if (likeArray.get(i).getHobby() == HobbyEnum.READING) {
                out[0]++;
            }
            else if (likeArray.get(i).getHobby() == HobbyEnum.ART) {
                out[1]++;
            }
            else if (likeArray.get(i).getHobby() == HobbyEnum.SPORTS) {
                out[2]++;
            }
            else if (likeArray.get(i).getHobby() == HobbyEnum.MUSIC) {
                out[3]++;
            }
            if (likeArray.get(i).getMajor() == MajorEnum.COMPSCI) {
                out[4]++;
            }
            else if (likeArray.get(i).getMajor() == MajorEnum.ENGINEERING) {
                out[5]++;
            }
            else if (likeArray.get(i).getMajor() == MajorEnum.MATH) {
                out[6]++;
            }
            else if (likeArray.get(i).getMajor() == MajorEnum.OTHER) {
                out[7]++;
            }
            if (likeArray.get(i).getState() == RegionEnum.SOUTHEAST) {
                out[8]++;
            }
            else if (likeArray.get(i).getState() == RegionEnum.NORTHEAST) {
                out[9]++;
            }
            else if (likeArray.get(i).getState() == RegionEnum.USOTHER) {
                out[10]++;
            }
            else if (likeArray.get(i).getState() == RegionEnum.OTHER) {
                out[11]++;
            }
        }
        return out;
    }


    /**
     * Gets the total number of heards in the song
     * 
     * @return int people who heard it
     */
    public int getTotalHeard() {
        return heardArray.size();
    }


    /**
     * Gets the total number of likes in the song
     * 
     * @return int people who like it
     */
    public int getTotalLikes() {
        return likeArray.size();
    }


    /**
     * Gets the percent of each sorting type
     * 
     * @param like
     *            true if like, false if heard
     * @return array of numbers of people who like/heard
     *         the song
     */
    public int[] getPercent(boolean like) {
        int[] out;
        if (like) {
            out = getNumLike();
            if (numLikeRead != 0) {
                out[0] = (int)(numLikeRead * 1.0 / totalRead * 100.0);
            }
            else {
                out[0] = 0;
            }
            if (numLikeArt != 0) {
                out[1] = (int)(numLikeArt * 1.0 / totalArt * 100.0);
            }
            else {
                out[1] = 0;
            }
            if (numLikeSports != 0) {
                out[2] = (int)(numLikeSports * 1.0 / totalSports * 100.0);
            }
            else {
                out[2] = 0;
            }
            if (numLikeMusic != 0) {
                out[3] = (int)(numLikeMusic * 1.0 / totalMusic * 100.0);
            }
            else {
                out[3] = 0;
            }
            if (numLikeComp != 0) {
                out[4] = (int)(numLikeComp * 1.0 / totalComp * 100.0);
            }
            else {
                out[4] = 0;
            }
            if (numLikeEng != 0) {
                out[5] = (int)(numLikeEng * 1.0 / totalEng * 100.0);
            }
            else {
                out[5] = 0;
            }
            if (numLikeMath != 0) {
                out[6] = (int)(numLikeMath * 1.0 / totalMath * 100.0);
            }
            else {
                out[6] = 0;
            }
            if (numLikeOther != 0) {
                out[7] = (int)(numLikeOther * 1.0 / totalOther * 100.0);
            }
            else {
                out[7] = 0;
            }
            if (numLikeSouth != 0) {
                out[8] = (int)(numLikeSouth * 1.0 / totalSouth * 100.0);
            }
            else {
                out[8] = 0;
            }
            if (numLikeNorth != 0) {
                out[9] = (int)(numLikeNorth * 1.0 / totalNorth * 100.0);
            }
            else {
                out[9] = 0;
            }
            if (numLikeUs != 0) {
                out[10] = (int)(numLikeUs * 1.0 / totalUs * 100.0);
            }
            else {
                out[10] = 0;
            }
            if (numLikeNon != 0) {
                out[11] = (int)(numLikeNon * 1.0 / totalNon * 100.0);
            }
            else {
                out[11] = 0;
            }
        }
        else {
            out = getNumHeard();
            if (numHeardRead != 0) {
                out[0] = (int)(numHeardRead * 1.0 / totalRead * 100.0);
            }
            else {
                out[0] = 0;
            }
            if (numHeardArt != 0) {
                out[1] = (int)(numHeardArt * 1.0 / totalArt * 100.0);
            }
            else {
                out[1] = 0;
            }
            if (totalSports != 0) {
                out[2] = (int)(numHeardSports * 1.0 / totalSports * 100.0);
            }
            else {
                out[2] = 0;
            }
            if (numHeardMusic != 0) {
                out[3] = (int)(numHeardMusic * 1.0 / totalMusic * 100.0);
            }
            else {
                out[3] = 0;
            }
            if (numHeardComp != 0) {
                out[4] = (int)(numHeardComp * 1.0 / totalComp * 100.0);
            }
            else {
                out[4] = 0;
            }
            if (numHeardEng != 0) {
                out[5] = (int)(numHeardEng * 1.0 / totalEng * 100.0);
            }
            else {
                out[5] = 0;
            }
            if (numHeardMath != 0) {
                out[6] = (int)(numHeardMath * 1.0 / totalMath * 100.0);
            }
            else {
                out[6] = 0;
            }
            if (numHeardOther != 0) {
                out[7] = (int)(numHeardOther * 1.0 / totalOther * 100.0);
            }
            else {
                out[7] = 0;
            }
            if (numHeardSouth != 0) {
                out[8] = (int)(numHeardSouth * 1.0 / totalSouth * 100.0);
            }
            else {
                out[8] = 0;
            }
            if (numHeardNorth != 0) {
                out[9] = (int)(numHeardNorth * 1.0 / totalNorth * 100.0);
            }
            else {
                out[9] = 0;
            }
            if (numHeardUs != 0) {
                out[10] = (int)(numHeardUs * 1.0 / totalUs * 100.0);
            }
            else {
                out[10] = 0;
            }
            if (numHeardNon != 0) {
                out[11] = (int)(numHeardNon * 1.0 / totalNon * 100.0);
            }
            else {
                out[11] = 0;
            }
        }

        return out;
    }


    /**
     * Outputs a to string for song
     * 
     * @return String representation of the song
     */
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("song title ");
        sb.append(title);
        sb.append("\nsong artist ");
        sb.append(artist);
        sb.append("\nsong genre ");
        sb.append(genre);
        sb.append("\nsong year ");
        sb.append(year);
        sb.append("\nheard\n");
        sb.append("reading" + getPercent(false)[0]);
        sb.append(" art" + getPercent(false)[1]);
        sb.append(" sports" + getPercent(false)[2]);
        sb.append(" music" + getPercent(false)[3]);
        sb.append("\nlikes\n");
        sb.append("reading" + getPercent(true)[0]);
        sb.append(" art" + getPercent(true)[1]);
        sb.append(" sports" + getPercent(true)[2]);
        sb.append(" music" + getPercent(true)[3] + "\n");
        return sb.toString();
    }


    /**
     * Creates total numbers for people in each major
     * 
     * @param p
     *            the person to add
     * @param i
     *            the count in the for loop
     */
    public void addPerson(Person p, int i) {
        addLike(p, true);
        addHeard(p, true);
    }
}
